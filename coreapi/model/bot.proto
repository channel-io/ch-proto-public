syntax = "proto3";

package coreapi.model;

import "buf/validate/validate.proto";
import "coreapi/model/name_desc.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.com/channel-io/ch-proto-public/coreapi/go/model";
option java_multiple_files = true;
option java_package = "io.channel.api.proto.coreapi.model";

// Bot represents a chatbot entity in a channel.
// AI bots (ALF) are excluded from public API operations.
message Bot {
  // Unique bot identifier.
  //
  // +kubebuilder:validation:Required
  // +kubebuilder:validation:MinLength=1
  string id = 1 [
    (buf.validate.field).cel = {
      id: "string.minLen"
      message: "value must be at least 1 characters"
      expression: "size(this) >= 1"
    },
    (buf.validate.field).required = true
  ];

  // Channel ID this bot belongs to.
  //
  // +kubebuilder:validation:Required
  // +kubebuilder:validation:MinLength=1
  string channel_id = 2 [
    (buf.validate.field).cel = {
      id: "string.minLen"
      message: "value must be at least 1 characters"
      expression: "size(this) >= 1"
    },
    (buf.validate.field).required = true
  ];

  // Bot display name.
  // Unique within the channel.
  //
  // +kubebuilder:validation:Required
  // +kubebuilder:validation:MinLength=1
  // +kubebuilder:validation:MaxLength=30
  string name = 3 [
    (buf.validate.field).cel = {
      id: "string.minLen"
      message: "value must be at least 1 characters"
      expression: "size(this) >= 1"
    },
    (buf.validate.field).cel = {
      id: "string.maxLen"
      message: "value must be no more than 30 characters"
      expression: "size(this) <= 30"
    },
    (buf.validate.field).required = true
  ];

  // Bot description.
  //
  // +kubebuilder:validation:Nullable
  // +kubebuilder:validation:MaxLength=180
  string description = 4 [(buf.validate.field).cel = {
    id: "string.maxLen"
    message: "value must be no more than 180 characters"
    expression: "size(this) <= 180"
  }];

  // Internationalized name and description map.
  // Keyed by locale.
  //
  // +kubebuilder:validation:Nullable
  map<string, coreapi.model.NameDesc> name_desc_i18n_map = 5;

  // Bot color in hex format.
  // Randomly assigned if not specified on creation.
  //
  // +kubebuilder:validation:Nullable
  // +kubebuilder:example="#3B82F6"
  string color = 6;

  // Bot avatar image URL.
  //
  // +kubebuilder:validation:Nullable
  string avatar_url = 7;

  // Bot creation timestamp.
  //
  // +kubebuilder:validation:Required
  google.protobuf.Timestamp created_at = 8 [(buf.validate.field).required = true];
}
